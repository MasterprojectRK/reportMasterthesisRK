\section{Related work}
In the last five years, several approaches have been presented to determine DNA-DNA interactions \emph{in silico}, 
using existing data from various experiments. \Cref{sec:prior:predictingInteractions} gives an overview about these methods.
Furthermore, some methods originally developed for image synthesis and similar tasks in computer vision might also be useful 
in the field of Hi-C matrix generation and are thus summarized in \autoref{sec:prior:generativeCV}.

\subsection{Methods for predicting DNA-DNA interactions and contact matrices} \label{sec:prior:predictingInteractions}
As of 2020, there is quite a body of existing work in the field of predicting DNA-DNA interactions, 
using various approaches and different types of input data.

Two conceptually similar methods have been proposed by Brackley et al. in 2016 and MacPherson et al. in 2018 \cite{Brackley2016, MacPherson2018}.
In both approaches, DNA is modeled as a ``beads-on-a-string'' polymer, and simulation techniques are employed to
find energy-optimal spatial structures of these polymers.
Apart from constraints derived from the molecule's DNA sequence itself, the models also consider spatial contact constraints derived from \acrshort{cs} experiments
of chromatin factors which are known to mediate such DNA-DNA contacts.
The interaction matrices derived from the simulations look interesting, 
but the paper from Brackley et al. \cite{Brackley2016} is unfortunately lacking a comparison with ``true'' experimentally measured Hi-C matrices, 
and the results from MacPherson et al. \cite{MacPherson2018} seem inferior to most other ones presented in this section.

Another simulation-based method has been developed by di Pierro et al. in 2017 \cite{Pierro2017} and later extended by Qi and Zhang \cite{Qi2019}. 
In both cases, a \acrfull{cnn} is trained to learn different ``open'' and ``closed'' chromatin states from 11 chromatin factors, 
and the predicted chromatin states are then taken as constraints for beads-on-a-string models.
The difference between \cite{Pierro2017} and \cite{Qi2019} lies mainly in the number of states considered and the simulation methods applied;
the results are mathematically convincing in both cases.

A further approach using chromatin states is due to Farr\`e and Emberly \cite{Farre2018}.
Here, the conditional probability of two genomic regions being in contact, given their distance and the chromatin state around them,
is estimated using Bayes' rule. 
In this case, the chromatin state -- reduced to active or inactive -- is derived from \acrfull{damid} signals of 53 chromatin factors using probabilistic methods \cite{Zhou2016}.
The conditional probabilities on the right side of Bayes' rule are either computed from training data or estimated with different probabilistic approaches, too.
While the predicted contact matrices do not look like real Hi-C matrices with this approach, highly interacting regions are still often well identifiable.

Three further approaches in the field make use of random forests. 
3DEpiLoop by Bkhetan and Plewczynski and Lollipop by Kai et al., 
both from 2018, use a random forest classifier to predict DNA loops, but differ in input data and preprocessing  \cite{Bkhetan2018, Kai2018}.
While 3DEpiLoop is using only \acrshort{cs} data of histone modifications and transcription factors \cite{Bkhetan2018},
Lollipop additionally takes \acrshort{chia}-, RNA-seq- and DNase-seq-data, CTCF motif orientation and loop length as inputs \cite{Kai2018}.
Both approaches show good coincidence of predicted loops with experimental data, but their output is binary and rather sparse.
Contrary to these two, the third random-forest-based approach, HiC-Reg by Zhang et al. from 2019, allows predicting real-valued
Hi-C interaction matrices directly~\cite{Zhang2019}. To this end, it employs random forest regression to predict interactions
between two genomic ``windows'', using \acrshort{cs} data of 13 chromatin factors and the genomic distance of the two windows.
The published results for five human cell lines look interesting, 
but could not be reproduced in two study projects at the university of Freiburg for unknown reasons~\cite{Krauth2020,Bajorat2019}

Another recent method which investigated decision-tree-based algorithms is due to Martens et al. (2020) \cite{Martens2020}.
Here, gradient boosted decision trees, logistic regression and neural networks were used to predict highly interacting chromatin regions
and \acrshort{tad} domain boundaries from histone modifications and CTCF \acrshort{cs} data. 
However, in this setup, the neural network approach yielded the best, overall acceptable results of the three approaches,
but again in form of a binary classifications.
A neural-network approach with comparable input data, but without the restriction to binary classifications has been presented by Farr\`e et al. in 2018 \cite{Farre2018a}. 
Here, a one-dimensional convolutional filter is used to convert \acrshort{cs} data from 50 chromatin factors into a 
one-dimensional chromatin vector, which is then processed by a \acrfull{dnn}.
This allows predicting real-valued Hi-C interaction matrices, which resemble the general structure of experimentally derived matrices quite well.

While the approaches discussed so far have either modeled DNA as a ``beads-on-a-string'' polymer or not used it explicitly at all,
there are also several machine-learning approaches which directly consider DNA sequence without a need for polymer modeling.
In 2019, Singh et al. presented SPEID \cite{Singh2019}, an approach to predict promoter-enhancer interactions from DNA sequence,
using a combination of \acrshort{cnn}s, a recurrent network (\acrshort{lstm}) and a \acrshort{dnn}.
The results match well with experimental data, but are limited to promoter and enhancer loci by design, disallowing predictions of complete Hi-C contact matrices.
Other researchers have tried to design similar methods without such limitations.
The work by Peng from 2017 \cite{peng2017} is an extension of SPEID, based on a 2016 preprint \cite{Singh2016}, 
additionally taking into account a ``middle sequence'' between enhancer- and promoter sequences,
CTCF motif counts within the sequences and genomic distance between two sequence snippets. 
However, the network lacks generalization, i.\,e. the results are only good in training regions \cite[figs. 4, 5]{peng2017}.
A conceptually similar method to the one by Peng \cite{peng2017}, but with a different neural network design has been presented by Schreiber et al., also in 2017, 
named Rambutan \cite{Schreiber2017}.
It accepts sequence, DNase-seq data and distance between two genomic loci as inputs 
and then uses a combination of \acrshort{cnn}s and a \acrshort{dnn} to predict whether the given two loci interact or not. 
Unfortunately, it is difficult to decide whether the results of Schreiber et al. are useful for the task at hand, since the evaluation is done only by statistical means 
and no actual Hi-C matrices have been published.
The original paper \cite{Schreiber2017} also contains a known error and seems not to have appeared in a peer-reviewed journal in improved form 
yet. 
A probably more promising method working on DNA sequence, Akita, has been published by Fudenberg et al. in 2020 \cite{Fudenberg2020}.
It is based on two rather involved \acrlong{cnn}s. 
While the first one, ``trunk'', processes one-dimensional, one-hot encoded DNA sequence input through convolutional filters, the second one, ``head'', 
converts one-dimensional representations to 2D, further processes the data with convolutional filters and enforces symmetry.
Although Fudenberg et al. initally seemed to focus on determining the influence of DNA modifications on spatial structure \cite{Fudenberg2019},
predicting complete Hi-C matrices is an integral part of their work, 
and a large number of images of Hi-C matrices from the test set has been published alongside the article. 
The predicted matrices often hardly look like experimental Hi-C matrices, but mostly still indicate highly interacting regions quite well.

A further method by Schwessinger et al. \cite{Schwessinger2019} also makes use of DNA sequence and additional epigenetic data for its predictions,
but is conceptually different from the ones presented so far.
Here, \acrshort{cs} tracks are initially used to train a \acrshort{cnn} on the relationship between sequence and 
the corresponding chromatin factors. The weights of this first network are then used to seed another \acrlong{cnn},
which is responsible for predicting DNA-DNA interactions from DNA sequence.
In this case, the results were blurry, but generally in good accordance with experimental Hi-C data.
However, the neural network has a large number of weights and thus requires long training times at very small batch sizes.

Yet another machine-learning concept based on sequence data, Samarth, has been proposed by Nikumbh and Pfeifer in 2017 \cite{Nikumbh2017}.
Here, a support vector machine is trained on 5C data, using a specific representation for DNA sequence called oligomer distance histograms.
The results showed acceptable consensus with experimental Hi-C data and allowed some interesting conclusions
about the importance of certain k-mers for DNA folding. 
Unfortunately, none of the predicted matrices used for statistical evaluation has been published alongside the paper,
making an assessment of the usefulness for the task at hand again difficult.

\subsection{Image synthesis techniques from computer vision} \label{sec:prior:generativeCV}
With the advent of deep learning, both the number of oppurtunities and the demand for using machine learning techniques 
in image synthesis tasks have risen, as recently summarized by Tsirikoglou et al. \cite{Tsirikoglou2020}.
Since Hi-C contact matrices can be seen as are square grayscale images, such techniques can also be relevant for this thesis.

One of the first applications of computer vision methods for Hi-C matrices was presented by Liu and Wang in 2019 \cite{Liu2019b}.
Here, deep \acrlong{cnn}s -- modified from established image super-resolution networks \xxx -- have been used to enhance low-resolution Hi-C matrices.

Another technique from computer vision that has been transferred to Hi-C matrices are conditional \acrlong{gan}s (\acrshort{gan}s), 
invented by Goodfellow, Mirza and colleagues in 2014 \cite{Goodfellow2014, mirza2014}. 
Again, several works have employed this comparatively new and involved method to increase the resolution of given Hi-C matrices, 
including the ones by Liu and colleagues \cite{Liu2019}, Hong et al. \cite{Hong2020} and Dimmick et al. \cite{Dimmick2020}.
In general, all three works feature the typical GAN setup with two competitive networks -- a generator, 
which is trained to produce realistic high-resolution Hi-C matrices from its low-resolution inputs, 
and a discriminator, which tries to distinguish real Hi-C matrices from generated ones and thus serves as a ``critique'', an additional loss function, for the generator.
While the convolutional building blocks for the discriminators and the residual building blocks for the generators are conceptually similar
in all cases, the three works differ in the number of building blocks used and the activation functions applied within the blocks.
Furthermore, Dimmick et al. and Hong et al. include additional loss functions beyond standard generator- and adversarial losses. 
This includes perceptual losses derived from other (pre-trained) neural networks to obtain ``visually good'' Hi-C matrices and total variation loss to suppress noise
while maintaining edges. 
The method by Dimmick et al. outperformed the others for most test cases, but it is also the most elaborated.

Since all of the methods presented above require existing Hi-C matrices for training \emph{and} prediction, none of them is suitable for the task at hand.
However, some of the concepts mentioned might still be useful, cf.\,\cref{sec:hi-cGAN}.



